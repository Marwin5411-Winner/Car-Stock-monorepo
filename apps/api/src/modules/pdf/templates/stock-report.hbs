<style>
  @page {
    size: A4 landscape;
    margin: 10mm;
  }
  body {
    font-family: 'Sarabun', sans-serif;
    font-size: 10px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 4px;
    vertical-align: top;
  }
  th {
    background-color: #f0f0f0;
    font-weight: bold;
    text-align: center;
    white-space: nowrap;
  }
  .text-right { text-align: right; }
  .text-center { text-align: center; }
  .header-row th {
    background-color: #e0e0e0;
  }
</style>

<div class="header">
  <div class="header-logo">
    <img src="{{header.logoBase64}}" alt="Logo">
  </div>
  <div class="header-info">
    <div class="company-name-wrapper">
      <div class="company-name">{{header.companyName}}</div>
      <div class="header-line"></div>
      <div class="header-address">
        {{header.address1}}<br>
        {{header.address2}}<br>
        {{header.phone}}
      </div>
    </div>
  </div>
</div>

<div class="document-title">รายงานสต็อกสินค้า (Stock Report)</div>

<div class="text-center" style="margin-bottom: 20px;">
  <strong>ข้อมูลวันที่:</strong> {{formatThaiDateWithDay (currentThaiDate)}}
</div>

<div class="section">
  <div class="section-title">สรุปภาพรวม</div>
  <table style="width: 100%; margin-bottom: 20px;">
    <thead>
      <tr>
        <th class="text-center">ทั้งหมด</th>
        <th class="text-center">พร้อมขาย</th>
        <th class="text-center">จองแล้ว</th>
        <th class="text-center">เตรียมส่งมอบ</th>
        <th class="text-center">ขายแล้ว</th>
        <th class="text-center">มูลค่ารวม (ต้นทุน)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
         <td class="text-center">{{summary.totalCount}}</td>
         <td class="text-center">{{summary.availableCount}}</td>
         <td class="text-center">{{summary.reservedCount}}</td>
         <td class="text-center">{{summary.preparingCount}}</td>
         <td class="text-center">{{summary.soldCount}}</td>
         <td class="text-right">{{formatCurrency summary.totalValue}}</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="section">
  <div class="section-title">รายการสินค้า</div>
  <table style="font-size: 9px;">
    <thead>
      <tr class="header-row">
        <th rowspan="2" style="width: 3%">No.</th>
        <th style="width: 15%">รุ่นรถ / สี</th>
        <th style="width: 15%">เลขถัง / เลขเครื่อง</th>
        <th rowspan="2" style="width: 5%">ที่จอด</th>
        <th rowspan="2" style="width: 6%">วันที่รับเข้า</th>
        <th rowspan="2" style="width: 4%">อายุ<br>(วัน)</th>
        <th colspan="4">ต้นทุน</th>
        <th rowspan="2" style="width: 8%">สถานะ</th>
        <th rowspan="2" style="width: 12%">ลูกค้าจอง</th>
      </tr>
      <tr class="header-row">
        <th>ภายนอก / ภายใน</th>
        <th>VIN / Engine No.</th>
        <th style="width: 6%">ราคารถ</th>
        <th style="width: 6%">ค่าใช้จ่าย</th>
        <th style="width: 5%">ดอกเบี้ย</th>
        <th style="width: 6%">รวม</th>
      </tr>
    </thead>
    <tbody>
      {{#each stocks}}
      <tr>
        <td class="text-center">{{add @index 1}}</td>
        <td>
          <b>{{brand}} {{model}} {{variant}}</b><br>
          <span style="color: #666;">{{exteriorColor}} / {{interiorColor}}</span>
        </td>
        <td>
          {{vin}}<br>
          <span style="color: #666;">{{engineNumber}}</span>
        </td>
        <td class="text-center">{{parkingSlot}}</td>
        <td class="text-center">{{formatThaiDate arrivalDate 'numeric'}}</td>
        <td class="text-center">{{daysInStock}}</td>
        <td class="text-right">{{formatCurrency baseCost}}</td>
        <td class="text-right">{{formatCurrency (add transportCost (add accessoryCost otherCosts))}}</td>
        <td class="text-right">{{formatCurrency accumulatedInterest}}</td>
        <td class="text-right"><b>{{formatCurrency totalCost}}</b></td>
        <td class="text-center">
          <span class="badge status-{{toLowerCase status}}">{{statusLabel}}</span>
        </td>
        <td>{{reservedBy}}</td>
      </tr>
      {{/each}}
      <tr style="font-weight: bold; background-color: #eee;">
        <td colspan="9" class="text-right">มูลค่ารวม</td>
        <td class="text-right">{{formatCurrency summary.totalValue}}</td>
        <td colspan="2"></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="footer" style="margin-top: 50px; text-align: right; font-size: 10px; color: #666;">
  พิมพ์เมื่อ: {{formatThaiDateWithDay (currentThaiDate)}}
</div>
