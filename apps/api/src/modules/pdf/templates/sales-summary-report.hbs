<style>
  @page {
    size: A4 landscape;
    margin: 10mm;
  }
  body {
    font-family: 'Sarabun', sans-serif;
    font-size: 10px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 4px;
    vertical-align: top;
  }
  th {
    background-color: #f2f2f2;
    font-weight: bold;
    text-align: center;
    white-space: nowrap;
    color: #333;
    border-bottom: 2px solid #ddd;
  }
  .text-right { text-align: right; }
  .text-center { text-align: center; }
  .header-row th {
    background-color: #003366; /* Dark Blue */
    color: white;
    border: 1px solid #002244;
  }
  .sub-header-row th {
    background-color: #f0f0f0;
    color: #333;
    font-size: 9px;
  }
</style>

<div class="header">
  <div class="header-logo">
    <img src="{{header.logoBase64}}" alt="Logo">
  </div>
  <div class="header-info">
    <div class="company-name-wrapper">
      <div class="company-name">{{header.companyName}}</div>
      <div class="header-line"></div>
      <div class="header-address">
        {{header.address1}}<br>
        {{header.address2}}<br>
        {{header.phone}}
      </div>
    </div>
  </div>
</div>

<div class="document-title">สรุปยอดขายตามช่วงเวลา</div>

<div class="text-center" style="margin-bottom: 20px;">
  <strong>ช่วงเวลา:</strong> {{dateRange}}
</div>

<div class="section">
  <table style="font-size: 9px;">
    <thead>
      <tr class="header-row">
        <th rowspan="2" style="width: 3%">ลำดับ</th>
        <th style="width: 12%">ชื่อ - สกุล</th>
        <th style="width: 10%">เลขเครื่อง</th>
        <th rowspan="2" style="width: 5%">ราคารถ</th>
        <th rowspan="2" style="width: 5%">ส่วนลด<br>ตัวรถ</th>
        <th rowspan="2" style="width: 4%">ดอกเบี้ย</th>
        <th rowspan="2" style="width: 5%">เงินดาวน์</th>
        <th rowspan="2" style="width: 5%">ค่างวด</th>
        <th rowspan="2" style="width: 5%">คงเหลือ</th>
        <th style="width: 5%">ยอดจัด</th>
        <th style="width: 5%">ค่าตอบ</th>
        <th rowspan="2" style="width: 5%">รวมรับเงิน</th>
        <th rowspan="2" style="width: 5%">วันที่ขาย</th>
        <th rowspan="2" style="width: 5%">ทะเบียน/พรบ<br>ขนส่ง</th>
        <th rowspan="2" style="width: 5%">ต้นทุน</th>
        <th rowspan="2" style="width: 5%">แคมเปญขาย</th>
        <th rowspan="2" style="width: 5%">กำไร<br>ขั้นต้น</th>
        <th rowspan="2" style="width: 4%">คอมฯ<br>พนักงาน</th>
        <th rowspan="2" style="width: 4%">ค่าใช้จ่าย<br>ขาย</th>
        <th rowspan="2" style="width: 4%">ค่าเบี้ย<br>ประกัน</th>
        <th rowspan="2" style="width: 5%">กำไรสุทธิ</th>
      </tr>
      <tr class="sub-header-row">
        <th>แบบรถ</th>
        <th>เลขคัซซี</th>
        <th>ซื้อไฟแนนซ์</th>
        <th>ไฟแนนซ์</th>
      </tr>
    </thead>
    <tbody>
      {{#each sales}}
      <tr>
        <td class="text-center">{{add @index 1}}</td>
        <td>
          {{customerName}}<br>
          <span style="color: #666;">{{vehicleModelName}}</span>
        </td>
        <td>
          {{engineNumber}}<br>
          <span style="color: #666;">{{chassisNumber}}</span>
        </td>
        <td class="text-right">{{formatCurrency totalAmount}}</td>
        <td class="text-right">{{formatCurrency discountAmount}}</td>
        <td class="text-right">{{formatCurrency interestCost}}</td>
        <td class="text-right">{{formatCurrency downPayment}}</td>
        <td class="text-right">-</td>
        <td class="text-right">{{formatCurrency remainingAmount}}</td>
        <td class="text-right">{{formatCurrency financeAmount}}</td>
        <td class="text-right">{{formatCurrency financeReturn}}</td>
        <td class="text-right">{{formatCurrency paidAmount}}</td>
        <td class="text-center">{{formatThaiDate saleDate 'numeric'}}</td>
        <td class="text-right">{{formatCurrency transportFee}}</td>
        <td class="text-right">{{formatCurrency totalCost}}</td>
        <td>{{campaignName}}</td>
        <td class="text-right">{{formatCurrency (subtract totalAmount totalCost)}}</td>
        <td class="text-right">{{formatCurrency salesCommission}}</td>
        <td class="text-right">{{formatCurrency salesExpense}}</td>
        <td class="text-right">{{formatCurrency insurancePremium}}</td>
        <td class="text-right">{{formatCurrency netProfit}}</td>
      </tr>
      {{/each}}
      <tr style="font-weight: bold; background-color: #eee;">
        <td colspan="3" class="text-right">รวมทั้งสิ้น ({{summary.totalSales}} คัน)</td>
        <td class="text-right">{{formatCurrency summary.totalAmount}}</td>
        <td class="text-right"></td>
        <td class="text-right"></td>
        <td class="text-right"></td>
        <td class="text-right"></td>
        <td class="text-right">{{formatCurrency summary.totalRemaining}}</td>
        <td class="text-right"></td>
        <td class="text-right"></td>
        <td class="text-right">{{formatCurrency summary.totalPaid}}</td>
        <td colspan="9"></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="footer" style="margin-top: 50px; text-align: right; font-size: 10px; color: #666;">
  พิมพ์เมื่อ: {{formatThaiDateWithDay (currentThaiDate)}}
</div>
